''' 
 Decription: 
 Arguments:
 Output: results object 
 data_wb = {
                'samples_size': samples_size,
                'chunk_sizes': chunk_size,
                'net_online': net_online_list,
                'net_online_mm': net_online_mm_list,
                'net_online_whole': net_online_whole,
                'net_offline': net_offline
            }
''' 
import pickle, os
import pandas as pd
import numpy as np
folder_path = './config_sim_data/wiebull/'
filename_list = ['wiebullshape1n10000','wiebullshape1n50000']
filetype = '.pkl'
col_name = ['filename','method','samp/ch_size','exp_l','exp_r','exp_range','error_l','error_r','error_range']
result_list = []
for filename in filename_list:
    file_re = os.path.join(folder_path,filename+'_re.pkl') # result file ended with _re words
    if os.path.isfile(file_re):
        
        # computing population min, max and rage from the simulated population .pkl file
        pop_data =  pd.read_pickle(folder_path+filename+'.pkl')    
        pop_min = np.min(pop_data)
        pop_max = np.max(pop_data)
        pop_range = pop_max-pop_min
        
        with open(file_re, 'rb') as file:
            loaded_data = pickle.load(file)        
        ch_size = loaded_data['chunk_sizes']
        for key, value in loaded_data.items():
            if 'net' in key:
                for net in value:
                    result = []
                    result.append((filename+'_re.pkl'))
                    if net.online is False:
                        result.append('net_offline')
                    else:
                        if net.minmax_boost is True:
                           result.append('net_online_mm')
                        else:
                            if net.total_size == net.chunk_size:
                               result.append('net_online_whole')
                            else:
                                result.append('net_online')
                    result.append(net.chunk_size)
                    result.append(net.exp_l)
                    result.append(net.exp_r)
                    result.append(net.range)
                    result.append(pop_min - net.exp_l)
                    result.append(pop_max - net.exp_r)
                    result.append(pop_range - net.range)
                    result_list.append(result)                
                                             
                        
                # if 'offline' in key:
                #     result = []
                #     result.append((filename+'_re.pkl'))
                #     net = value
                #     flag = True
                # elif 'whole' in key:
                #     result = []
                #     result.append((filename+'_re.pkl'))
                #     net = value
                #     flag = True
                # else:
                #     for ch in range(len(ch_size)):
                #         result = []
                #         result.append((filename+'_re.pkl'))
                #         net = value[ch]
                #         if net.minmax_boost is False:
                #             result.append('net_online')
                #         else:
                #             result.append('net_online_mm')
                #         result_list.append(result)
                # if flag:
                #     result_list.append(result)
                # result = [] # the row list contain the values refering to the `col_name` variable
                # result.append((filename+'_re.pkl'))
                # if 'online_whole' in key:
                #     result.append(key)
                # elif 'online_mm' in key:
                #     result.append(key)
                # elif 'online' in key:
                #     result.append(key)
                # else:
                #     result.append(key)
                # for ch in ch_size:
                        
            
                    
                 
        # net_name = 'net_offline'    
        # net = loaded_data[net_name]
        # result.append((filename+'_re.pkl'))
        # result.append(net_name)
        # if 'offline' in net_name:
        #     result.append(net['samples_size'])
        # elif 'whole' in net_name:    
        #     result.append(net['samples_size'])
        # else:
        #     result.append(net['samples_size'])    
    

# filetype = '.pkl'
# pop_data =  pd.read_pickle(folder_path+filename+'.pkl')    
# pop_min = np.min(pop_data)
# pop_max = np.max(pop_data)
# pop_range = pop_max-pop_min
# with open(os.path.join(folder_path,filename+'_re'+filetype), 'rb') as file:
#     loaded_data = pickle.load(file)

# print("Data loaded from pickle file:")
# print(loaded_data)